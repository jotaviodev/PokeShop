<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PokeShop</title>
  <link rel="stylesheet" href="index.css" />
  <link href="https://fonts.googleapis.com/css2?family=Rubik&display=swap" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"> 
  <script src="./js/api.js"></script>
  <script src="./js/common.js"></script>
  <script>
    window.addEventListener('load', async ()=>{
      let div = document.getElementsByClassName('container-cards')[0]
      let categorias 
      
      try {
        categorias = await ApiClient.getCategorias();
        
        categorias.map((categoria)=>{
          div.innerHTML += `
          <a href="./pages/cardsCategoria.html?categoria=${categoria.nome}">
          <div class="card">
            <h2>Cartas tipo ${categoria.nome}</h2>
            <img src="${categoria.url_imagem}"/>
          </div>
          </a>
        `
        })
      } catch (error) {
        console.error('Erro ao carregar categorias:', error);
        NotificationManager.show('Erro ao carregar categorias. Mostrando categorias padrão.', 'warning');
        div.innerHTML = `
          <a href="./cardsEnergia/cardsEstadio.html">
            <div class="card">
              <h2>Cartas tipo Estádio</h2>
              <img src="https://assets.pokemon.com/static-assets/content-assets/cms2-pt-br/img/cards/web/SWSH11/SWSH11_PT-BR_171.png"/>
            </div>
          </a>
          <a href="./cardsPokemon/cardsPokemon.html">
            <div class="card">
              <h2>Cartas tipo Pokémon</h2>
              <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/destined-rivals/pt-br/SV10_PTBR_104-2x.png"/>
            </div>
          </a>
          <a href="./cardsItem/cardsItem.html">
            <div class="card">
              <h2>Cartas tipo Item</h2>
              <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/battle-partners/pt-br/SV9_PTBR_130-2x.png"/>
            </div>
          </a>
          <a href="./cardsApoiador/cardsApoiador.html">
            <div class="card">
              <h2>Cartas tipo Apoiador</h2>
              <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/battle-partners/pt-br/SV9_PTBR_198-2x.png"/>
            </div>
          </a>
        `;
      }
    })

    function checkUserLogin() {
      const user = localStorage.getItem('user');
      if (user) {
        const userData = JSON.parse(user);
        document.getElementById('loginLink').style.display = 'none';
        document.getElementById('registerLink').style.display = 'none';
        document.getElementById('userMenu').style.display = 'block';
        document.getElementById('userNameNav').textContent = `Olá, ${userData.nome_completo || userData.name || 'Usuário'}`;
      }
    }

    function logout() {
      if (confirm('Deseja realmente sair?')) {
        localStorage.removeItem('user');
        localStorage.removeItem('token');
        localStorage.removeItem('cart');
        window.location.reload();
      }
    }

    window.addEventListener('load', checkUserLogin);
  </script>
</head>
<body>
  <nav class="navbar">
        <div class="logo">
            <img src="./assets/pokelogo.png" alt="Logo PokeShop" />
        </div>
        <div class="nav-item">
            <div class="nav-sessao">
                <a href="./pages/cart.html" title="Carrinho">
                    <i class="fa-solid fa-cart-shopping"></i>
                    <span>Carrinho</span>
                    <span class="cart-counter" style="background: #e74c3c; color: white; border-radius: 50%; padding: 2px 6px; font-size: 12px; margin-left: 5px; display: none;">0</span>
                </a>
            </div>
            <div class="nav-sessao">
                <a href="./auth/signIn.html" id="loginLink">Entrar</a>
            </div>
            <div class="nav-sessao">
                <a href="./auth/signUp.html" id="registerLink">Criar conta</a>
            </div>
            <div class="nav-sessao" id="userMenu" style="display: none;">
                <span id="userNameNav">Olá, </span>
                <a href="#" onclick="logout()" id="logoutLink">Sair</a>
            </div>
        </div>
    </nav>

  <section class="sessao">
    <h1 class="sessao-titulo">1. Categorias e Cartas Disponíveis</h1>
    <div class="container-cards">
      <!-- <a href="./cardsEnergia/cardsEstadio.html">
        <div class="card">
          <h2>Cartas tipo Estádio</h2>
          <img src="https://assets.pokemon.com/static-assets/content-assets/cms2-pt-br/img/cards/web/SWSH11/SWSH11_PT-BR_171.png"/>
        </div>
      </a>
      <a href="./cardsPokemon/cardsPokemon.html">
        <div class="card">
          <h2>Cartas tipo Pokémon</h2>
          <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/destined-rivals/pt-br/SV10_PTBR_104-2x.png"/>
        </div>
      </a>
      <a href="./cardsApoiador/cardsApoiador.html">
        <div class="card">
          <h2>Cartas tipo Apoiador</h2>
          <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/destined-rivals/pt-br/SV10_PTBR_170-2x.png"/>
        </div>
      </a>
      <a href="./cardsItem/cardsItem.html">
        <div class="card">
          <h2>Cartas tipo Item</h2>
          <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/destined-rivals/pt-br/SV10_PTBR_179-2x.png"/>
        </div>
      </a> -->
    </div>
  </section>

  <section class="sessao">
    <h1 class="sessao-titulo">2. Top 5 Cartas Mais Vendidas</h1>
    <p style="color: red; margin: 5px;">Produtos esgotados, apenas exibição!</p>
    <div class="container-cards">
      <div class="card-poke">
        <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/prismatic-evolutions/pt-br/SV8pt5_PTBR_6-2x.png"/>
      </div>
      <div class="card-poke">
        <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/prismatic-evolutions/pt-br/SV8pt5_PTBR_14-2x.png"/>
      </div>
      <div class="card-poke">
        <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/prismatic-evolutions/pt-br/SV8pt5_PTBR_23-2x.png"/>
      </div>
      <div class="card-poke">
        <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/prismatic-evolutions/pt-br/SV8pt5_PTBR_26-2x.png"/>
      </div>
      <div class="card-poke">
        <img src="https://dz3we2x72f7ol.cloudfront.net/expansions/prismatic-evolutions/pt-br/SV8pt5_PTBR_60-2x.png"/>
      </div>
    </div>
  </section>
</body>
</html>
